# IDTF 端到端威脅模型 (STRIDE) 與參考拓撲

**版本**: 1.0
**日期**: 2025-10-15
**作者**: 林志錚 Michael Lin(Chih Cheng Lin)(Chih Cheng Lin) Michael Lin(Chih Cheng Lin)

---

## 1. 概述

本文件旨在為 IDTF (Industrial Digital Twin Framework) 建立一個端到端威脅模型，採用 STRIDE 方法論來識別潛在的安全威脅，並提出基於 Purdue 模型/ISA-95 分層的最小權限與網段隔離參考拓撲。隨著工業控制系統 (ICS) 與企業 IT 系統的融合，數位分身平台面臨日益複雜的網路安全挑戰。本指南將提供範例原則和樣板設定，以協助實施者設計和部署一個安全、具韌性的 IDTF 環境。

## 2. STRIDE 威脅模型分析

STRIDE 是一種常用的威脅模型分析方法，它將威脅分為六種類型：Spoofing (假冒)、Tampering (篡改)、Repudiation (否認)、Information Disclosure (資訊洩露)、Denial of Service (拒絕服務) 和 Elevation of Privilege (權限提升)。以下將針對 IDTF 的主要組件進行 STRIDE 分析。

### 2.1 IDTF 主要組件

IDTF 的核心組件包括：

*   **數據源 (Data Sources)**：OT 設備 (PLC, SCADA, DCS)、MES、ERP、CAD/PLM 等。
*   **NDH Connector Agents**：負責從數據源提取數據並傳輸到 NDH。
*   **Neutral Data Hub (NDH)**：數據匯聚、情境化、儲存和管理的核心平台。
*   **IADL/FDL Editor**：用於定義資產類型和工廠佈局的工具。
*   **應用與服務 (Applications & Services)**：基於 NDH 數據構建的各種應用，如監控儀表板、預測性維護、AI 分析等。
*   **使用者 (Users)**：操作員、維護工程師、數據分析師、管理員等。

### 2.2 STRIDE 威脅分析表

| 威脅類型 | 描述 | 潛在威脅場景 (針對 IDTF) | 緩解措施 |
|:---|:---|:---|:---|
| **Spoofing (假冒)** | 攻擊者假冒合法用戶、設備或服務。 | 1. 惡意設備假冒合法 OT 設備向 NDH 傳輸錯誤數據。<br>2. 攻擊者假冒合法用戶登錄 NDH 或應用。 | 1. 嚴格的身份驗證 (MFA, 證書認證)。<br>2. 設備身份認證 (如 X.509 證書、MAC 地址過濾)。<br>3. 網路分段與信任邊界。 |
| **Tampering (篡改)** | 攻擊者未經授權修改數據或系統。 | 1. 數據在傳輸或儲存過程中被篡改。<br>2. 惡意用戶修改 IADL/FDL 定義，導致資產模型錯誤。<br>3. 應用程式代碼被篡改。 | 1. 數據完整性檢查 (哈希、數位簽章)。<br>2. 傳輸加密 (TLS/SSL)。<br>3. 嚴格的訪問控制 (RBAC/ABAC)。<br>4. 數據版本控制與審計日誌。 |
| **Repudiation (否認)** | 攻擊者否認其行為，導致無法追溯。 | 1. 用戶否認執行了某項操作 (如修改配置、發送命令)。<br>2. 設備否認發送了某條數據。 | 1. 完善的審計日誌，記錄所有關鍵操作。<br>2. 數位簽章與不可否認性機制。 |
| **Information Disclosure (資訊洩露)** | 敏感數據未經授權被洩露。 | 1. 商業機密或 PII 數據被未授權用戶訪問。<br>2. 數據庫洩露。<br>3. 網路嗅探獲取敏感數據。 | 1. 數據加密 (靜態與動態)。<br>2. 細粒度訪問控制 (RBAC/ABAC)。<br>3. 網路分段與防火牆。<br>4. 數據分類與標籤。 |
| **Denial of Service (拒絕服務)** | 攻擊者阻止合法用戶訪問系統或服務。 | 1. 大量惡意請求導致 NDH 或 Connector Agent 過載。<br>2. 網路攻擊導致數據傳輸中斷。<br>3. 惡意程式碼導致系統崩潰。 | 1. 流量限制與 DDoS 防護。<br>2. 系統冗餘與高可用性設計。<br>3. 資源隔離與監控。<br>4. 健全的錯誤處理機制。 |
| **Elevation of Privilege (權限提升)** | 攻擊者獲得超出其應有權限的訪問。 | 1. 軟體漏洞被利用，導致普通用戶獲得管理員權限。<br>2. 配置錯誤導致權限過高。 | 1. 定期安全漏洞掃描與修補。<br>2. 最小權限原則。<br>3. 嚴格的配置管理與審查。<br>4. 安全編碼實踐。 |

## 3. 最小權限與網段隔離參考拓撲 (Purdue 模型/ISA-95 對齊)

為了有效緩解上述威脅，IDTF 應部署在一個遵循最小權限原則和嚴格網段隔離的網路環境中。Purdue 模型和 ISA-95 標準為工業網路分層提供了成熟的框架。

### 3.1 Purdue 模型/ISA-95 分層概述

| 層級 | 名稱 | 描述 | IDTF 組件部署建議 |
|:---|:---|:---|:---|
| **Level 5** | Enterprise Zone (企業區) | 企業 IT 系統，如 ERP、PLM、商業應用。 | IDTF 應用與服務 (使用者介面、BI 工具) 可部署在此層，透過安全閘道訪問 NDH。 |
| **Level 4** | Business Planning & Logistics (業務規劃與物流) | MES、排程系統、數據庫。 | NDH 的核心數據庫、部分應用服務可部署在此層。與 Level 5 之間有嚴格的防火牆和訪問控制。 |
| **Level 3** | Manufacturing Operations Management (製造營運管理) | MES、SCADA、歷史數據庫、製造執行系統。 | NDH Connector Agents (與 MES、SCADA 互動部分) 可部署在此層。與 Level 4 之間有嚴格的防火牆和訪問控制。 |
| **Level 2** | Control Systems (控制系統) | PLC、DCS、HMI。 | NDH Connector Agents (與 PLC/DCS 互動部分) 可部署在此層。與 Level 3 之間有嚴格的防火牆和訪問控制。 |
| **Level 1** | Basic Control (基本控制) | 感測器、執行器。 | 不直接部署 IDTF 組件，但數據透過 Level 2 採集。 |
| **Level 0** | Process (製程) | 物理製程。 | 不直接部署 IDTF 組件。 |

### 3.2 參考拓撲設計原則

*   **嚴格的網路分段**：每個 Purdue 層級應被視為一個獨立的信任區域，並透過防火牆、VLAN 或 SDN (Software-Defined Networking) 進行物理或邏輯隔離。
*   **最小權限訪問**：
    *   **垂直方向**：只允許必要的通訊流穿越層級邊界，且應透過專用、受控的通道 (如 DMZ、數據二極管) 進行。
    *   **水平方向**：在同一層級內，不同功能模組之間也應實施最小權限原則，避免不必要的橫向通訊。
*   **單向數據流**：盡可能實現從 OT 到 IT 的單向數據流，減少 OT 網路暴露於 IT 威脅的風險。對於從 IT 到 OT 的控制指令，應透過嚴格審核和驗證的閘道進行。
*   **DMZ (Demilitarized Zone)**：在 IT 和 OT 網路之間設置 DMZ，用於部署數據交換伺服器、協議轉換器和安全閘道。
*   **身份與訪問管理 (IAM)**：在每個層級實施強大的 IAM 策略，包括多因素驗證 (MFA) 和基於角色的訪問控制 (RBAC)。
*   **日誌與監控**：在所有網路邊界和關鍵組件上部署日誌收集和安全監控系統 (SIEM)，實時檢測異常行為。

### 3.3 範例原則與樣板設定

#### 3.3.1 網路隔離原則

*   **OT 網路 (Level 0-2)**：應與 IT 網路完全隔離，除非有明確的業務需求且經過嚴格安全審核。所有進入 OT 網路的通訊必須經過 DMZ。
*   **NDH Connector Agent 部署**：Connector Agent 應部署在靠近數據源的層級 (Level 2 或 Level 3)，並僅具有對數據源的只讀訪問權限，以及對 NDH 的寫入權限。
*   **NDH 核心部署**：NDH 核心服務 (數據庫、API 服務) 應部署在 Level 4 或獨立的數據中心區域，並透過安全的 API 閘道對外提供服務。

#### 3.3.2 防火牆規則樣板 (範例)

| 源區域 | 目標區域 | 協議/埠 | 允許/拒絕 | 說明 |
|:---|:---|:---|:---|:---|
| Level 2 (控制系統) | DMZ (Connector Agent) | OPC UA (4840), Modbus TCP (502) | 允許 | 允許 OT 數據採集到 Connector Agent。 |
| DMZ (Connector Agent) | Level 4 (NDH Core) | gRPC (50051), HTTPS (443) | 允許 | 允許 Connector Agent 將數據寫入 NDH。 |
| Level 5 (企業區) | Level 4 (NDH Core) | HTTPS (443) | 允許 | 允許企業應用透過安全 API 訪問 NDH。 |
| Level 4 (NDH Core) | Level 5 (企業區) | 任何 | 拒絕 | 預設拒絕從 NDH 核心主動發起到企業區的連接。 |
| 任何 | 任何 | SSH (22), RDP (3389) | 拒絕 (除特定管理跳板機外) | 限制遠端管理訪問，必須透過安全跳板機。 |

#### 3.3.3 最小權限配置樣板 (範例)

*   **NDH Connector Agent 服務帳戶**：
    *   在 OT 數據源系統中，配置為只讀帳戶，僅能訪問必要的數據點。
    *   在 NDH 中，配置為僅能寫入特定數據流或資產屬性的帳戶。
*   **NDH 用戶角色**：
    *   **操作員**：只能查看生產數據和儀表板。
    *   **維護工程師**：可以查看設備狀態、歷史數據和維護記錄，可能具有觸發某些控制命令的權限 (需嚴格審核)。
    *   **數據分析師**：可以訪問所有歷史數據和遙測數據，但無權修改資產定義或控制設備。
    *   **平台管理員**：擁有最高權限，負責用戶管理、系統配置和安全策略。

## 4. 結論

透過實施 STRIDE 威脅模型分析和基於 Purdue 模型/ISA-95 的最小權限與網段隔離參考拓撲，IDTF 將能夠顯著提升其網路安全態勢。這不僅有助於保護工業數據和控制系統免受網路攻擊，還能確保數位分身平台的穩定運行和數據的可靠性。本文件提供的原則和樣板設定將作為實施安全 IDTF 環境的基礎，並應根據具體的工廠環境和風險評估進行調整和細化。
