# IDTF (Industrial Digital Twin Framework) 介紹

**文件編號**: IDTF-Introduction-V1.0
**版本**: 1.0
**日期**: 2025-10-16
**作者**: 林志錚 Michael Lin(Chih Cheng Lin)

---

## 目錄

1.  [簡介](#1-簡介)
2.  [設計理念](#2-設計理念)
3.  [核心組件](#3-核心組件)
4.  [生態系統架構](#4-生態系統架構)
5.  [工作流程](#5-工作流程)
6.  [IDTF V3.5/V3.6 主要更新](#6-idtf-v35v36-主要更新)
7.  [技術優勢](#7-技術優勢)
8.  [應用場景](#8-應用場景)
9.  [安全與治理](#9-安全與治理)
10. [工程化考量](#10-工程化考量)
11. [商業與案例輸出](#11-商業與案例輸出)
12. [結論與展望](#12-結論與展望)

---

## 1. 簡介

**IDTF (Industrial Digital Twin Framework)** 是一個全面的工業數位分身框架，旨在實現「**一次建模，到處使用**」的願景。它整合了資產定義、工廠設計、數據整合、3D 視覺化以及 AI Agent 協作等核心能力，提供從設計到執行的端到端解決方案，加速工業 4.0 的轉型。

### 1.1 核心價值主張

*   **標準化資產定義**: 透過 IADL 定義可重用的資產藍圖，支援多維度視圖與完整的生命週期管理，並深度符合 ISA-95 標準。
*   **視覺化工廠設計**: 透過 Factory Designer 設計工廠佈局，精確實例化資產，並支援 BIM/CAD 整合。
*   **中立數據中樞**: 透過 NDH 整合異構系統的數據，實現數據的統一管理與流動，並支援實時數據處理。
*   **企業級視覺化**: 透過 Omniverse 實現 3D 數位分身，提供豐富的視覺化與互動體驗。
*   **智能 Agent 協作**: 引入 MCP Control Plane 和 Agent SDK，使 AI Agent 能夠訂閱事件、決策與下指令，實現智能優化與控制。

### 1.2 目標用戶

*   **工廠工程師**: 設計和部署工廠資產，進行佈局規劃。
*   **系統整合商**: 整合多廠商設備和系統，構建複雜的數位分身解決方案。
*   **數位轉型團隊**: 建立企業級數位分身平台，推動智能化升級。
*   **設備製造商**: 提供標準化的資產模型，提升產品附加價值。
*   **AI/OT 開發者**: 開發和部署智能 Agent，實現自動化決策與控制。

---

## 2. 設計理念

IDTF 採用清晰的分層架構、關注點分離、開放標準、可擴展性與豐富的數據模型，確保其在工業場景中的適用性和高性能。

### 2.1 分層架構

IDTF 採用清晰的分層架構，每一層都有明確的職責，確保系統的模組化和可維護性：

```
┌─────────────────────────────────────────────────────────────┐
│                    Apps / Dashboards                        │
│                         ▲                                   │
│                         │ WS/HTTP                           │
├─────────────────────────────────────────────────────────────┤
│  Service Layer     |  REST / GraphQL / WS                    │
├─────────────────────────────────────────────────────────────┤
│  Processing Layer  |  Stream / Batch / AI                    │
├─────────────────────────────────────────────────────────────┤
│  NDH (Data Hub)    |  Kafka/TSDB/Postgres/Redis  +  Event Bus │
├─────────────────────────────────────────────────────────────┤
│  Data Acquisition  |  OPC UA / MQTT / ...                    │
├────────────────────┬─────────────────────┬──────────────────┤
│            ▲       │                     │                  │
│            │       │ agents/#            │ ndh/#            │
│            │       │  (MQTT Topics)      │ telemetry / events / cmds │
│  MCP Control Plane | <-----------------> |  Agent Runtimes  │
│  (registry, ACL,   |                     |  (py/go/node)    │
│   scheduler, audit)|                     |  SDK + policies  │
└────────────────────┴─────────────────────┴──────────────────┘
```

### 2.2 關注點分離

*   **IADL**: 專注於「資產是什麼」(What)，包括其多維度視圖和生命週期狀態定義。
*   **FDL**: 專注於「工廠如何佈局」(How)，以及資產實例的精確定位與邏輯關聯。
*   **NDH**: 專注於「數據如何流動」(Flow)，作為數據整合與管理的核心。
*   **Omniverse**: 專注於「如何視覺化」(Visualization)，提供 3D 數位分身體驗。
*   **MCP Control Plane**: 專注於「Agent 如何協作」(How Agents Collaborate)，管理 Agent 的生命週期和通訊。

### 2.3 開放標準與標準符合性

*   基於開放標準 (USD, OPC UA, MQTT, REST/GraphQL)。
*   **明確支援 ISA-95 設備階層模型**，提供 IADL 元素與 ISA-95 層級的詳細映射。
*   支援多廠商設備整合，避免廠商鎖定。

### 2.4 可擴展性與靈活性

*   模組化設計，易於擴展新功能和組件。
*   支援從單一工廠到多廠部署，從數百到數萬資產的規模。
*   允許自訂階層深度與命名慣例，並提供模組化擴展點。

### 2.5 豐富的數據模型與生命週期管理

*   **IADL 支援豐富的資產數據模型**，包含識別資訊、階層關聯、工程屬性、營運屬性、維護屬性、財務屬性、狀態資訊、關聯文件和連接關係。
*   **FDL 實例化資產時，可繼承並擴展 IADL 定義的豐富屬性**，並包含實例特有的運營和維護資訊。
*   **全面涵蓋資產生命週期**，從設計、採購、製造、部署、運營到退役，並支援各階段的數據與狀態管理。

---

## 3. 核心組件

### 3.1 IADL (Industrial Asset Definition Language)

**用途**: 定義單一資產的完整藍圖，支援多維度視圖和生命週期狀態管理。

**特性**:
*   基於 YAML 的聲明式語言，透過 JSON Schema 進行規範和驗證。
*   包含 3D 模型、數據標籤、行為模型。
*   支援資產繼承和組合，具備版本控制和生命週期管理。
*   **明確定義 ISA-95 八級階層**，並支援「次要階層」的邏輯分組。
*   **擴展核心屬性**，包含更全面的識別、工程、營運、維護、財務、狀態、文件和連接關係資訊。

### 3.2 IADL Editor (Asset Designer)

**用途**: 視覺化的資產建模工具，支援豐富數據模型和階層架構細化。

**特性**:
*   拖放式介面設計，3D 模型預覽，數據標籤配置，行為模型編輯，IADL 代碼生成。
*   **支援 ISA-95 主要階層和次要階層的定義與管理**。
*   **提供工具以配置和管理 IADL 擴展的核心屬性**。
*   與 CAD/PLM 系統整合，自動化從工程設計到數位分身定義的過程。

### 3.3 Factory Designer

**用途**: 工廠級佈局設計工具，精確描述資產實例的物理部署和邏輯關聯。

**特性**:
*   2D/3D 佈局編輯器，資產庫管理，自動 FDL 生成，一鍵部署到 NDH。
*   **基於 IADL 範本自動生成 FDL 實例**，並允許使用者填寫實例特有資訊。
*   **支援 FDL 實例的 ISA-95 階層歸屬和邏輯分組引用**。

### 3.4 FDL (Factory Design Language)

**用途**: 定義工廠佈局和配置，精確描述資產實例的物理部署和邏輯關聯。

**特性**:
*   定義資產實例的數量、位置、連接關係，以及區域、樓層和建築物階層。
*   **FDL 實例包含其在 ISA-95 階層中的位置資訊和完整的 ISA-95 階層路徑**。
*   **FDL 實例可引用其所屬的「次要階層」分組**。
*   **擴展 FDL 實例核心屬性**，包含更全面的識別、工程、營運、維護、財務、狀態、文件和連接關係資訊。
*   **FDL 實例包含其當前的生命週期狀態** (如 `operational_status`)。

### 3.5 NDH (Neutral Data Hub)

**用途**: 執行時數據整合和管理，支援資產實例的生命週期數據和多維度數據流。

**特性**:
*   接收 FDL 並實例化資產物件，整合多種 OT/IT 數據源，提供統一的 API 介面。
*   支援即時數據流處理，時序數據儲存和查詢。
*   **管理資產實例的生命週期狀態和相關事件記錄**。
*   **支援從 FDL 實例中配置的動態數據源採集數據**。
*   內建 MQTT Broker，作為 Agent 之間以及 Agent 與 MCP 之間的主要通訊通道。

### 3.6 Omniverse Integration

**用途**: 企業級 3D 視覺化平台，實現數位分身的實時渲染和互動。

**特性**:
*   即時 3D 渲染，物理模擬，多人協作，USD 場景管理，數據綁定和動畫。
*   支援 EnergyOptimizerAgent 等 AI Agent 的模擬結果視覺化。

### 3.7 MCP (Multi-Agent Control Plane)

**用途**: 管理和協調 AI Agent 的生命週期和通訊，實現智能決策與控制。

**特性**:
*   **Agent Registry**: 負責 Agent 的註冊、發現和元數據管理。
*   **Event Dispatcher**: 將來自 NDH 或其他 Agent 的事件分發到訂閱的 Agent。
*   **State Manager**: 接收 Agent 發布的狀態更新，並持久化到 IADL State Memory 中。
*   **ACL & Policy Engine**: 實施基於角色或屬性的訪問控制，確保 Agent 只能訪問其被授權的數據和資源。
*   **Scheduler**: 負責 Agent 任務的排程和協調。
*   **Audit Log**: 記錄所有 Agent 的活動、決策和通訊。

### 3.8 Agent Runtimes (Agent SDK)

**用途**: 簡化 AI Agent 的開發、部署和管理，提供標準化的介面和工具。

**特性**:
*   **Agent 註冊與生命週期管理**: 提供 API 供 Agent 註冊、啟動、停止和更新其狀態。
*   **MQTT 通訊介面**: 封裝 MQTT 客戶端，提供簡單易用的發布/訂閱介面，支援 `agents/#` 和 `ndh/#` Topic Namespace。
*   **NDH API 客戶端**: 提供用於存取 NDH REST/GraphQL API 的客戶端庫。
*   **IADL/FDL 數據模型抽象**: 提供數據模型抽象層，使 Agent 能夠以物件導向的方式操作 IADL/FDL 數據。
*   **狀態記憶管理**: 提供介面供 Agent 讀取和寫入其在 IADL State Memory 中的狀態。
*   支援多種主流程式語言 (Python, Go, Node.js)，並整合 LangGraph、AutoGen 或 CrewAI 等開源 Agent orchestration SDK。

---

## 4. 生態系統架構

IDTF V3.6 的完整生態系統架構如下圖所示，它清晰地劃分了設計時與運行時的職責，並展示了各組件之間的數據流和互動關係：

```
┌─────────────────────────────────────────────────────────────┐
│                    IDTF V3.6 生態系統                        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Design Time (離線設計)          Runtime (線上執行)          │
│  ┌──────────────────┐            ┌──────────────────┐      │
│  │  IADL Editor     │            │      NDH         │      │
│  │  (資產建模)       │            │  (數據中樞)       │      │
│  └────────┬─────────┘            └────────▲─────────┘      │
│           │                               │                 │
│           │ IADL 檔案 (含多維度視圖,生命週期定義) │ 即時數據         │
│           ▼                               │                 │
│  ┌──────────────────┐                     │                 │
│  │ Factory Designer │─────────────────────┘                 │
│  │  (工廠佈局)       │   FDL 檔案 (含實例化資產,邏輯關聯) + 部署 │
│  └──────────────────┘                                       │
│           │                                                  │
│           │ USD 場景                                         │
│           ▼                                                  │
│  ┌──────────────────┐                                       │
│  │    Omniverse     │                                       │
│  │  (3D 視覺化)      │                                       │
│  └──────────────────┘                                       │
│                                                              │
│            ▲                         ▲                       │
│            │                         │                       │
│            │ agents/#                │ ndh/#                 │
│            │  (MQTT Topics)          │ telemetry / events / cmds │
│  ┌────────────────────┐        ┌────────────────────┐      │
│  │  MCP Control Plane │ <----> │  Agent Runtimes    │      │
│  │  (registry, ACL,   │        │  (py/go/node)      │      │
│  │   scheduler, audit)│        │  SDK + policies    │      │
│  └────────────────────┘        └────────────────────┘      │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 數據流向

1.  **設計階段**: IADL Editor → IADL 檔案 (包含豐富數據模型、多維度視圖、生命週期定義) → Factory Designer
2.  **配置階段**: Factory Designer → FDL 檔案 (包含精確實例化資產、ISA-95 階層路徑、邏輯關聯) → NDH
3.  **執行階段**: 實體設備 → OT 數據 → NDH → Omniverse
4.  **視覺化**: NDH → USD 場景 → Omniverse → 使用者
5.  **智能決策**: NDH 事件 → MCP Control Plane → Agent Runtimes (Agent SDK) → NDH Actions/Logs → 實體設備/Omniverse

---

## 5. 工作流程

### 典型工作流程

1.  **資產建模**: 使用 IADL Editor 定義資產藍圖，包括 3D 模型、數據標籤、行為腳本、ISA-95 階層歸屬、次要階層分組、生命週期狀態和擴展屬性。
2.  **工廠佈局設計**: 使用 Factory Designer 匯入 IADL 資產，在 2D/3D 編輯器中進行佈局，為資產實例指定 ISA-95 階層路徑和邏輯分組，並自動生成 FDL 配置。
3.  **部署到 NDH**: Factory Designer 一鍵部署 FDL 到 NDH API，NDH 實例化資產物件，建立數據連接，啟動數據採集，並根據 FDL 實例的生命週期狀態進行管理。
4.  **視覺化**: NDH 推送資產實例到 Omniverse，生成 USD 場景，綁定即時數據，渲染 3D 視覺化，並支援多人協作。
5.  **智能優化與控制**: MCP Control Plane 協調 Agent Runtimes 中的 AI Agent，監聽 NDH 事件，執行決策，並將控制指令回寫至 NDH，影響實體設備或 Omniverse 模擬。
6.  **監控與優化**: 持續監控即時數據和告警，分析歷史趨勢，調整工廠佈局或 Agent 策略，並重新部署更新。

---

## 6. IDTF V3.5/V3.6 主要更新

### 6.1 IDTF V3.5 核心更新

*   **Factory Designer**: 引入核心工具，填補從「資產建模」到「工廠部署」之間的關鍵缺口，實現視覺化設計、自動化部署和即時回饋。
*   **架構優化**: 完整的端到端工作流程 (IADL Editor → Factory Designer → NDH → 實體工廠)，生態系統閉環，支援 BIM/CAD 整合，多工廠支援。
*   **強化標準符合性**: 深度整合 ISA-95 和參考 ISO 15926/CFIHOS 標準的數據字典。
*   **全面的生命週期管理**: 從設計到退役的資產全生命週期數據與狀態追蹤。
*   **多維度資產視圖**: 支援主要階層與次要階層並存的混合模型，提供靈活的資產組織方式。

### 6.2 IDTF V3.6 核心更新 (MCP / AI Agent 擴充)

*   **MCP (Multi-Agent Control Plane)**: 在 NDH 之上引入獨立服務層，負責管理和協調 AI Agent 的生命週期和通訊，提供 Agent 註冊、事件分發、狀態管理、ACL 和審計等核心功能。
*   **Agent SDK**: 提供一套標準化的介面和工具，簡化 AI Agent 的開發、部署和管理，使其能夠輕鬆地與 MCP Control Plane 和 NDH 互動，支援多種語言和開源 Agent orchestration SDK (如 LangGraph / AutoGen / CrewAI)。
*   **Reference Agents**: 優先實作三個可驗證價值的 Reference Agents：
    *   **Energy-Optimizer Agent**: 監控能源消耗，優化工廠能源使用，降低能耗和成本。
    *   **Maintenance-Advisor Agent**: 監控設備狀態，預測潛在故障，提供維護建議。
    *   **Safety-Sentinel Agent**: 監控工廠環境和設備安全，預警危險情況，觸發安全響應。

---

## 7. 技術優勢

### 7.1 標準化

*   **開放標準**: 基於 USD, OPC UA, MQTT, REST/GraphQL 等開放標準。
*   **廠商中立**: 不綁定特定廠商或平台，避免廠商鎖定。
*   **互操作性**: 支援多廠商設備整合，實現數據和系統的無縫連接。
*   **ISA-95 符合性**: 核心資產階層模型嚴格遵循 ISA-95 標準，確保與企業級系統的整合。

### 7.2 可重用性

*   **資產藍圖**: 一次定義，到處使用，極大提高設計效率。
*   **模板庫**: 豐富的資產模板庫，加速新資產的創建。
*   **繼承機制**: 支援資產繼承和組合，提高模型的靈活性和可維護性。
*   **中央類別庫**: 建立基於 ISO 15926/CFIHOS 的數據字典，確保數據一致性。

### 7.3 可擴展性

*   **模組化設計**: 易於擴展新功能和組件，適應不斷變化的業務需求。
*   **水平擴展**: 支援大規模部署，滿足不同規模工廠的需求。
*   **垂直整合**: 從設備到雲端的完整整合，實現數據的端到端流動。
*   **靈活的階層與屬性擴展**: 允許自訂階層深度、命名慣例和資產屬性。

### 7.4 易用性

*   **視覺化工具**: 拖放式介面設計，降低技術門檻，提升設計效率。
*   **自動化**: 自動生成配置和代碼，減少人工錯誤，加速部署。
*   **即時回饋**: 即時驗證和錯誤提示，提高開發效率。

### 7.5 企業級

*   **高可用性**: 支援叢集部署，確保系統穩定運行。
*   **安全性**: 完整的認證和授權機制，保護數據安全。
*   **監控**: 完整的日誌和監控體系，便於系統運維。
*   **全面的生命週期數據管理**: 支援資產全生命週期的數據追蹤和管理。

---

## 8. 應用場景

IDTF 廣泛應用於多種工業場景，助力企業實現數位轉型。

### 8.1 智慧製造

*   **生產線數位分身**: 即時監控生產狀態，優化生產流程。
*   **預測性維護**: 基於數據的設備維護，減少停機時間。
*   **品質管理**: 即時品質監控和追溯，提升產品品質。
*   **能源管理**: 優化能源消耗，降低運營成本。
*   **資產生命週期優化**: 透過全面的生命週期數據，優化資產運營和維護策略。

### 8.2 設施管理

*   **建築數位分身**: 整合 BIM 和 IoT，實現智能建築管理。
*   **HVAC 優化**: 智能空調控制，提高能源效率。
*   **空間管理**: 空間利用率分析，優化資源配置。
*   **安全監控**: 即時安全告警，提升設施安全性。

### 8.3 多廠管理

*   **集團級監控**: 統一監控多個工廠，實現集中管理。
*   **標準化部署**: 快速複製成功經驗，加速全球擴張。
*   **資源優化**: 跨廠資源調度，提升整體效益。
*   **績效比較**: 多廠績效對標，促進內部競爭和改進。

### 8.4 虛擬調試

*   **設計驗證**: 在虛擬環境中驗證設計，減少實體測試成本。
*   **控制邏輯測試**: 測試 PLC 程式，確保控制系統的穩定性。
*   **培訓模擬**: 操作員培訓，提高操作技能。
*   **災難演練**: 緊急情況模擬，提升應急響應能力。

### 8.5 遠程運維

*   **遠程監控**: 跨地域監控工廠，實現遠程管理。
*   **專家支援**: AR 遠程指導，提高維護效率。
*   **虛擬巡檢**: VR 工廠巡檢，減少現場工作量。
*   **協同作業**: 多人協作，提升團隊效率。

---

## 9. 安全與治理

NDH 作為「單一事實來源」至關重要，因此安全與治理是 IDTF 的核心考量。

### 9.1 端到端威脅模型 (STRIDE)

IDTF 採用 STRIDE 威脅模型對整個系統進行威脅分析，確保從數據採集到應用層的每個環節都得到充分保護。

### 9.2 最小權限與網段隔離

*   **參考拓撲**: 對齊 Purdue 模型/ISA-95 分層架構，實施最小權限原則和網段隔離，限制未經授權的訪問。
*   **RBAC/ABAC**: 實施基於角色 (Role-Based Access Control) 或屬性 (Attribute-Based Access Control) 的訪問控制，精細化權限管理。
*   **PII/商業機密保護**: 針對個人身份信息 (PII) 和商業機密數據，實施加密、脫敏和嚴格的訪問策略。

### 9.3 數據產品治理與審計

*   **租戶/空間/數據產品治理**: 建立清晰的數據所有權、使用權和生命週期管理策略。
*   **審計**: 記錄所有數據訪問、修改和 Agent 決策行為，提供完整的審計日誌，確保數據的可追溯性和合規性。

---

## 10. 工程化考量

為確保 IDTF 的高效開發、部署和維護，我們在工程化方面進行了以下考量：

### 10.1 Mono-repo Workspace

採用 Mono-repo 結構管理所有專案代碼、文件和配置，提高協作效率和代碼一致性。

### 10.2 CI/CD (持續整合/持續部署)

*   **CI (Continuous Integration)**: 實施自動化 Lint、Schema 驗證和合約測試，確保代碼品質和規範符合性。
*   **CD (Continuous Deployment)**: 建立自動化部署流程，實現快速、可靠的發佈。

### 10.3 E2E 測試

開發端到端 (End-to-End) 測試腳本，透過合成數據流重放 OPC UA/MQTT → NDH → Omniverse/MES 的最小案例，驗證系統的整體功能和穩定性。

### 10.4 版本管理與發佈

*   **Releases/Tags**: 採用語義化版本控制，定期發佈版本並打上 Tag。
*   **CHANGELOG**: 維護詳細的 CHANGELOG，記錄每個版本的變更內容。
*   **第三方授權清單**: 維護 Apache-2.0 等開源授權的第三方組件清單，確保合規性。

### 10.5 Quickstart 一鍵體驗

提供「Quickstart 一鍵體驗」指南，讓使用者能夠在 10 分鐘內跑通最小案例 (含語料、場景與 Dashboard)，快速了解 IDTF 的核心功能和價值。

---

## 11. 商業與案例輸出

為便於對外包裝和推廣，IDTF 將提供一系列可複製的解決方案藍本，展示其在不同行業和場景中的應用價值。

### 11.1 解決方案藍本

*   **Harvatek 新廠**: 針對新建工廠的數位化轉型，提供從設計到運營的完整解決方案。
*   **Small LNG**: 針對小型液化天然氣廠，優化生產流程和安全管理。
*   **TSMC FMCS**: 針對半導體工廠的設施管理與控制系統，提升運維效率。
*   **GB300 數據中心**: 針對大型數據中心，實現能源優化和智能運維。

每個藍本將包含 As-Is/To-Be 分析、ROI 假設、整合點與潛在風險，為客戶提供清晰的價值主張和實施路徑。

---

## 12. 結論與展望

IDTF 是一個不斷演進的框架，從 V3.5 引入 Factory Designer 到 V3.6 擴充 MCP / AI Agent，我們持續強化其在工業數位分身領域的領先地位。透過標準化、模組化、智能化的設計，IDTF 不僅提供了一個強大的技術平台，更為企業實現智能製造、高效運營和可持續發展提供了堅實的基礎。

未來，IDTF 將繼續探索更多前沿技術，如邊緣 AI、區塊鏈在工業數據溯源中的應用，以及更深度的跨領域整合，以應對工業數位化帶來的挑戰和機遇。
