# IDTF V3.5 總覽

**文件編號**: IDTF-V3.5-01  
**版本**: 3.5  
**日期**: 2025-10-15  
**作者**: 林志錚 Michael Lin(Chih Cheng Lin)(Chih Cheng Lin) Michael Lin(Chih Cheng Lin)

---

## 目錄

1. [簡介](#簡介)
2. [設計理念](#設計理念)
3. [核心組件](#核心組件)
4. [生態系統架構](#生態系統架構)
5. [工作流程](#工作流程)
6. [V3.5 主要更新](#v35-主要更新)
7. [技術優勢](#技術優勢)
8. [應用場景](#應用場景)

---

## 簡介

**IDTF (Industrial Digital Twin Framework)** 是一個完整的工業數位分身框架,旨在實現「**一次建模,到處使用**」的願景。IDTF V3.5 整合了資產定義、工廠設計、數據整合和 3D 視覺化等核心能力,提供從設計到執行的端到端解決方案。

### 核心價值主張

- **標準化資產定義**: 透過 IADL 定義可重用的資產藍圖，並支援多維度視圖與完整的生命週期管理。
- **視覺化工廠設計**: 透過 Factory Designer 設計工廠佈局，並精確實例化資產。
- **中立數據中樞**: 透過 NDH 整合異構系統的數據，實現數據的統一管理與流動。
- **企業級視覺化**: 透過 Omniverse 實現 3D 數位分身，提供豐富的視覺化與互動體驗。

### 目標用戶

- **工廠工程師**: 設計和部署工廠資產
- **系統整合商**: 整合多廠商設備和系統
- **數位轉型團隊**: 建立企業級數位分身平台
- **設備製造商**: 提供標準化的資產模型

---

## 設計理念

### 1. 分層架構

IDTF 採用清晰的分層架構,每一層都有明確的職責:

![IDTF 分層架構](../images/idtf_layered_architecture.png)

```
┌─────────────────────────────────────────┐
│     應用層 (Applications)                │
│  Dashboard | Analytics | Control        │
├─────────────────────────────────────────┤
│     視覺化層 (Visualization)             │
│  Omniverse | Web3D | AR/VR              │
├─────────────────────────────────────────┤
│     服務層 (Services)                    │
│  API Gateway | Auth | Notification      │
├─────────────────────────────────────────┤
│     數據處理層 (Data Processing)         │
│  Stream Processing | Analytics | ML     │
├─────────────────────────────────────────┤
│     數據中樞層 (Data Hub)                │
│  NDH - Kafka | InfluxDB | PostgreSQL    │
├─────────────────────────────────────────┤
│     數據採集層 (Data Collection)         │
│  OPC UA | MQTT | Modbus | BACnet        │
├─────────────────────────────────────────┤
│     資產層 (Assets)                      │
│  Physical Assets | Sensors | Actuators  │
└─────────────────────────────────────────┘
```

### 2. 關注點分離

- **IADL**: 專注於「資產是什麼」(What)，包括其多維度視圖和生命週期狀態定義。
- **FDL**: 專注於「工廠如何佈局」(How)，以及資產實例的精確定位與邏輯關聯。
- **NDH**: 專注於「數據如何流動」(Flow)
- **Omniverse**: 專注於「如何視覺化」(Visualization)

### 3. 開放標準與標準符合性

- 基於開放標準 (USD, OPC UA, MQTT)
- **明確支援 ISA-95 設備階層模型**，提供 IADL 元素與 ISA-95 層級的詳細映射。
- 支援多廠商設備整合
- 避免廠商鎖定

### 4. 可擴展性與靈活性

- 模組化設計,易於擴展
- 支援從單一工廠到多廠部署
- 支援從數百到數萬資產
- **允許自訂階層深度與命名慣例**，並提供模組化擴展點。

### 5. 豐富的資料模型與生命週期管理

- **IADL 支援豐富的資產資料模型**，包含識別資訊、階層關聯、工程屬性、營運屬性、維護屬性、財務屬性、狀態資訊、關聯文件和連接關係。
- **FDL 實例化資產時，可繼承並擴展 IADL 定義的豐富屬性**，並包含實例特有的運營和維護資訊。
- **全面涵蓋資產生命週期**，從設計、採購、製造、部署、運營到退役，並支援各階段的資料與狀態管理。

---

## 核心組件

### 1. IADL (Industrial Asset Definition Language)

**用途**: 定義單一資產的完整藍圖，支援多維度視圖和生命週期狀態管理。

**特性**:
- 基於 YAML 的聲明式語言
- 包含 3D 模型、數據標籤、行為模型
- 支援資產繼承和組合
- 版本控制和生命週期管理
- **明確定義 ISA-95 八級階層**，並支援「次要階層」的邏輯分組。
- **擴展核心屬性**，包含更全面的識別、工程、營運、維護、財務、狀態、文件和連接關係資訊。

**範例**:

```yaml
asset_type: Pump
model: StandardPump_v1.0
manufacturer: ACME
metadata:
  category: Fluid_Handling
  power_rating: 15kW
lifecycle_status: design_in_progress # 新增生命週期狀態
logical_groups: # 新增邏輯分組
  - type: discipline
    name: mechanical
  - type: maintenance
    name: critical_equipment_list
3d_model:
  format: USD
  path: models/pump_standard.usd
data_tags:
  - name: Status
    type: String
    source: OPC_UA
    node_id: ns=2;s=Pump.Status
```

### 2. IADL Editor

**用途**: 視覺化的資產建模工具，支援豐富數據模型和階層架構細化。

**特性**:
- 拖放式介面設計
- 3D 模型預覽
- 數據標籤配置
- 行為模型編輯
- IADL 代碼生成
- **支援 ISA-95 主要階層和次要階層的定義與管理**。
- **提供工具以配置和管理 IADL 擴展的核心屬性**。

### 3. Factory Designer ⭐ (V3.5 更新)

**用途**: 工廠級佈局設計工具，精確實例化資產並支援多維度視圖。

**特性**:
- 2D/3D 佈局編輯器
- 資產庫管理
- 自動 FDL 生成
- 一鍵部署到 NDH
- 即時狀態監控
- **基於 IADL 範本自動生成 FDL 實例**，並允許使用者填寫實例特有資訊。
- **支援 FDL 實例的 ISA-95 階層歸屬和邏輯分組引用**。

**工作流程**:

![Factory Designer 工作流程](../images/factory_designer_workflow.png)

### 4. FDL (Factory Design Language)

**用途**: 定義工廠佈局和配置，精確描述資產實例的物理部署和邏輯關聯。

**特性**:
- 定義資產實例的數量和位置
- 定義資產之間的連接關係
- 定義區域、樓層和建築物階層
- 支援多工廠配置
- **FDL 實例包含其在 ISA-95 階層中的位置資訊和完整的 ISA-95 階層路徑**。
- **FDL 實例可引用其所屬的「次要階層」分組**。
- **擴展 FDL 實例核心屬性**，包含更全面的識別、工程、營運、維護、財務、狀態、文件和連接關係資訊。
- **FDL 實例包含其當前的生命週期狀態** (如 `operational_status`)。

**範例**:

```yaml
factory_layout:
  - area: ProductionFloor1
    building: MainBuilding
    floor: 1
    instances:
      - type: StandardPump
        count: 5
        naming_prefix: "Pump_"
        location: "x:10, y:20, z:0"
        instance_id: Pump_001 # 新增實例ID
        serial_number: SN-12345 # 新增序列號
        isa95_hierarchy_path: "Enterprise/SiteA/Area1/ProductionFloor1/Pump_001" # 新增ISA-95路徑
        logical_group_references: # 新增邏輯分組引用
          - discipline: mechanical
          - maintenance_group: critical_equipment_list
        operational_status: running # 新增運營狀態
```

### 5. NDH (Neutral Data Hub)

**用途**: 執行時數據整合和管理，支援資產實例的生命週期數據和多維度數據流。

**特性**:
- 接收 FDL 並實例化資產物件
- 整合多種 OT/IT 數據源
- 提供統一的 API 介面
- 支援即時數據流處理
- 時序數據儲存和查詢
- **管理資產實例的生命週期狀態和相關事件記錄**。
- **支援從 FDL 實例中配置的動態數據源採集數據**。

**架構**:

![NDH 架構](../images/ndh_architecture.png)

### 6. Omniverse Integration

**用途**: 企業級 3D 視覺化平台

**特性**:
- 即時 3D 渲染
- 物理模擬
- 多人協作
- USD 場景管理
- 數據綁定和動畫

---

## 生態系統架構

IDTF V3.5 的完整生態系統架構如下:

![IDTF 生態系統](../images/idtf_ecosystem.png)

```
┌─────────────────────────────────────────────────────────────┐
│                    IDTF V3.5 生態系統                        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Design Time (離線設計)          Runtime (線上執行)          │
│  ┌──────────────────┐            ┌──────────────────┐      │
│  │  IADL Editor     │            │      NDH         │      │
│  │  (資產建模)       │            │  (數據中樞)       │      │
│  └────────┬─────────┘            └────────▲─────────┘      │
│           │                               │                 │
│           │ IADL 檔案 (含多維度視圖,生命週期定義) │ 即時數據         │
│           ▼                               │                 │
│  ┌──────────────────┐                     │                 │
│  │ Factory Designer │─────────────────────┘                 │
│  │  (工廠佈局)       │   FDL 檔案 (含實例化資產,邏輯關聯) + 部署 │
│  └──────────────────┘                                       │
│           │                                                  │
│           │ USD 場景                                         │
│           ▼                                                  │
│  ┌──────────────────┐                                       │
│  │    Omniverse     │                                       │
│  │  (3D 視覺化)      │                                       │
│  └──────────────────┘                                       │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 數據流向

1. **設計階段**: IADL Editor → IADL 檔案 (包含豐富數據模型、多維度視圖、生命週期定義) → Factory Designer
2. **配置階段**: Factory Designer → FDL 檔案 (包含精確實例化資產、ISA-95 階層路徑、邏輯關聯) → NDH
3. **執行階段**: 實體設備 → OT 數據 → NDH → Omniverse
4. **視覺化**: NDH → USD 場景 → Omniverse → 使用者

---

## 工作流程

### 典型工作流程

![IDTF 工作流程](../images/idtf_workflow.png)

#### 步驟 1: 資產建模

使用 IADL Editor 定義資產藍圖:

- 選擇資產類型和模板
- 配置 3D 模型
- 定義數據標籤
- 編寫行為模型
- **定義資產的 ISA-95 階層歸屬和次要階層分組**。
- **配置資產的生命週期狀態和相關屬性**。
- 匯出 IADL 檔案

#### 步驟 2: 工廠佈局設計

使用 Factory Designer 設計工廠佈局:

- 匯入 IADL 資產到資產庫
- 在 2D/3D 編輯器中拖放資產
- 定義區域和樓層結構
- 繪製連接關係
- **為資產實例指定 ISA-95 階層路徑和邏輯分組引用**。
- **配置資產實例的動態數據源連接資訊**。
- 自動生成 FDL 配置

#### 步驟 3: 部署到 NDH

Factory Designer 一鍵部署:

- 驗證 FDL 正確性
- 推送 FDL 到 NDH API
- NDH 實例化資產物件
- 建立數據連接
- 啟動數據採集
- **NDH 根據 FDL 實例的生命週期狀態進行管理**。

#### 步驟 4: 視覺化

Omniverse 即時視覺化:

- NDH 推送資產實例到 Omniverse
- 生成 USD 場景
- 綁定即時數據
- 渲染 3D 視覺化
- 支援多人協作

#### 步驟 5: 監控與優化

持續監控和優化:

- 查看即時數據和告警
- 分析歷史趨勢
- 調整工廠佈局
- 重新部署更新

---

## V3.5 主要更新

### 🆕 Factory Designer

Factory Designer 是 V3.5 版本的核心新增功能,它填補了從「資產建模」到「工廠部署」之間的關鍵缺口。

#### 核心功能

1. **資產庫管理**
   - 匯入和管理 IADL 檔案
   - 資產預覽和搜尋
   - 版本控制
   - **支援 IADL 範本庫和範本繼承機制**。

2. **2D/3D 佈局設計器**
   - 拖放式資產配置
   - 區域和樓層定義
   - 連接關係繪製
   - BIM 模型匯入
   - **支援 ISA-95 主要階層和次要階層的視覺化配置**。

3. **FDL 生成與編輯**
   - 自動生成 FDL
   - 語法高亮編輯器
   - 雙向同步
   - **自動繼承 IADL 範本屬性並允許實例化定制**。

4. **NDH 整合與部署**
   - 一鍵部署
   - 即時狀態監控
   - 反向同步

#### 技術亮點

- **視覺化設計**: 將複雜的 FDL 編寫轉化為直觀操作
- **自動化部署**: 極大縮短從設計到上線的時間
- **即時回饋**: 與 NDH 直接連結,即時驗證設計
- **生態閉環**: 完成 IDTF 生態系統的最後一塊拼圖

### 🔄 架構優化

- **完整的端到端工作流程**: IADL Editor → Factory Designer → NDH → 實體工廠
- **生態系統閉環**: 從設計到執行的完整閉環
- **BIM/CAD 整合**: 支援從 Revit 等 BIM 軟體匯入 3D 建築模型
- **多工廠支援**: 使用同一套資產藍圖部署多個工廠
- **強化標準符合性**: 深度整合 ISA-95 和參考 ISO 15926/CFIHOS 標準的數據字典。
- **全面的生命週期管理**: 從設計到退役的資產全生命週期數據與狀態追蹤。
- **多維度資產視圖**: 支援主要階層與次要階層並存的混合模型，提供靈活的資產組織方式。

---

## 技術優勢

### 1. 標準化

- **開放標準**: 基於 USD, OPC UA, MQTT 等開放標準
- **廠商中立**: 不綁定特定廠商或平台
- **互操作性**: 支援多廠商設備整合
- **ISA-95 符合性**: 核心資產階層模型嚴格遵循 ISA-95 標準。

### 2. 可重用性

- **資產藍圖**: 一次定義,到處使用
- **模板庫**: 豐富的資產模板庫
- **繼承機制**: 支援資產繼承和組合
- **中央類別庫**: 建立基於 ISO 15926/CFIHOS 的數據字典，確保數據一致性。

### 3. 可擴展性

- **模組化設計**: 易於擴展新功能
- **水平擴展**: 支援大規模部署
- **垂直整合**: 從設備到雲端的完整整合
- **靈活的階層與屬性擴展**: 允許自訂階層深度、命名慣例和資產屬性。

### 4. 易用性

- **視覺化工具**: 拖放式介面設計
- **自動化**: 自動生成配置和代碼
- **即時回饋**: 即時驗證和錯誤提示

### 5. 企業級

- **高可用性**: 支援叢集部署
- **安全性**: 完整的認證和授權機制
- **監控**: 完整的日誌和監控體系
- **全面的生命週期數據管理**: 支援資產全生命週期的數據追蹤和管理。

---

## 應用場景

### 1. 智慧製造

- **生產線數位分身**: 即時監控生產狀態
- **預測性維護**: 基於數據的設備維護
- **品質管理**: 即時品質監控和追溯
- **能源管理**: 優化能源消耗
- **資產生命週期優化**: 透過全面的生命週期數據，優化資產運營和維護策略。

### 2. 設施管理

- **建築數位分身**: 整合 BIM 和 IoT
- **HVAC 優化**: 智能空調控制
- **空間管理**: 空間利用率分析
- **安全監控**: 即時安全告警

### 3. 多廠管理

- **集團級監控**: 統一監控多個工廠
- **標準化部署**: 快速複製成功經驗
- **資源優化**: 跨廠資源調度
- **績效比較**: 多廠績效對標

### 4. 虛擬調試

- **設計驗證**: 在虛擬環境中驗證設計
- **控制邏輯測試**: 測試 PLC 程式
- **培訓模擬**: 操作員培訓
- **災難演練**: 緊急情況模擬

### 5. 遠程運維

- **遠程監控**: 跨地域監控工廠
- **專家支援**: AR 遠程指導
- **虛擬巡檢**: VR 工廠巡檢
- **協同作業**: 多人協作

---

## 總結

IDTF V3.5 透過引入 Factory Designer,完成了從設計到執行的完整生態系統閉環。它不僅是一個技術框架,更是一個完整的工業數位轉型解決方案。本次更新更深度整合了 ISA-95 標準，強化了資產的多維度視圖和生命週期管理能力，並擴展了 IADL 和 FDL 的數據模型，使其在靈活性、可擴展性和數據豐富性方面達到新的高度。

### 核心價值

1. **端到端工作流程**: 從資產建模到工廠運行的完整流程
2. **視覺化設計**: 降低技術門檻,提升設計效率
3. **標準化**: 基於開放標準,避免廠商鎖定，並深度符合 ISA-95 標準。
4. **可重用性**: 一次建模,到處使用，並透過中央類別庫確保數據一致性。
5. **企業級**: 支援大規模、高可用部署，並提供全面的生命週期數據管理。

### 下一步

- 閱讀 [IADL 規範](02_IADL_Specification.md) 了解資產定義語言
- 閱讀 [Factory Designer 設計](04_Factory_Designer.md) 了解工廠佈局工具
- 閱讀 [NDH 架構](06_NDH_Architecture.md) 了解數據中樞設計
- 查看 [應用案例](09_Use_Cases.md) 了解實際應用

---

**讓我們一起建構工業 4.0 的未來!** 🚀

